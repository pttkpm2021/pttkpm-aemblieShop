const order_limit_qty=5;function getParameterByName(e,t=window.location.href){e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}if($(".fade-in-on-load").each(function(){this.complete?$(this).css("opacity","1"):$(this).bind("load",function(){$(this).css("opacity","1")})}),$("#button_cart_buyNow").length){function plus(){var e=parseInt($(".number.orders").text());e>=order_limit_qty-1?($(".plus.orders").css("pointer-events","none"),$(".plus.orders i").css("background-color","rgb(204, 204, 204)"),$(".number.orders").text(order_limit_qty)):($(".number.orders").text(e+1),$(".minus.orders").css("pointer-events","all"),$(".minus.orders i").css("background-color","rgb(40, 138, 214)"))}function minus(){var e=parseInt($(".number.orders").text());e<=2?($(".minus.orders").css("pointer-events","none"),$(".minus.orders i").css("background-color","rgb(204, 204, 204)"),$(".number.orders").text(1)):($(".number.orders").text(e-1),$(".plus.orders").css("pointer-events","all"),$(".plus.orders i").css("background-color","rgb(40, 138, 214)")),$(".ordered").attr("disabled",!1),$(".plChoose-proColor").remove()}$(document).ready(function(){var e=localStorage.getItem("local_cartAllAmount");null===e||e<=0?($(".ordered").text("Đặt mua"),$(".seecart").remove()):$(".ordered").text("Thêm vào giỏ hàng"),$(".image-popup-no-margins").magnificPopup({type:"image",closeOnContentClick:!0,closeBtnInside:!1,fixedContentPos:!0,mainClass:"mfp-no-margins mfp-with-zoom",image:{verticalFit:!0},zoom:{enabled:!0,duration:300}})}),$("#button_cart_buyNow").click(function(){$(".popup-detail").fadeIn(50),$(".popup-detail").addClass("active"),$("body").attr("style","overflow:hidden")}),$(".close-popup").click(function(){$(".popup-detail").fadeOut(0),$(".popup-detail").removeClass("active"),$("body").removeAttr("style"),$(".choose-colorPro ul li").removeClass("active"),$(".number").text(1),$(".ordered").attr("disabled",!1)}),$(".choose-colorPro ul li").click(function(){$(".choose-colorPro ul li").removeClass("active"),$(this).addClass("active"),$(".plChoose-proColor").remove(),$(".ordered").attr("disabled",!1)}),$(".ordered").click(function(){if($(".choose-colorPro ul li").hasClass("active")){var e=parseInt($(".choose-colorPro ul li.active").attr("data-exProductId")),t=parseInt($(".number").text()),a=parseInt($(".basket-cart-amount").text())+t,n=[$("#tloc").val()];if(""!=n){const a=(n=JSON.parse("["+n+"]")).find(t=>Math.trunc(t/10)===e),o=n.indexOf(a);if(a){if(a%10+t>order_limit_qty)return $("#orderCheck").append(`<span class="plChoose-proColor">*Sản phẩm chỉ được mua tối đa số lượng ${order_limit_qty}, giỏ hàng của bạn đang có ${a%10} sản phẩm.</span>`),void $(".ordered").attr("disabled",!0);n[o]=e+String(a%10+t)}else n.push(e+String(t))}else n=[e+String(t)];$("#tloc").val(n),$(".basket-cart-amount").text(a),localStorage.setItem("local_cartAllAmount",a),$("#cartAddInfo").remove(),$.ajax({type:"POST",url:"/cart/add",data:{exProductId:`${e}`,qty:`${t}`,cartAllAmount:`${a}`,cartAll:`${n}`},dataType:"json",timeout:1e4,success:function(e){var t=`\n                        <tbody id="cartAddInfo">\n                            <tr>\n                                <td></td>\n                                <td class="text-center" style="color:#3fb846">Thêm vào giỏ hàng thành công\n                                </td>\n                            </tr>\n                            <tr class="minicart-separator">\n                                    <td>\n                                        <a href="${e.product.path_url}">\n                                            <img src="/uploads/${e.extendProduct.path_image}" width="80" height="80">\n                                        </a>\n                                    </td>\n                                    <td>\n                                        <a href="${e.product.path_url}">\n                                            ${e.product.name}\n                                        </a>\n                                        <p>\n                                            <span class="none price-cart">${e.product.price.toLocaleString("it-IT")}<sup style="font-size:smaller">₫</sup>\n                                            </span><span>&nbsp;x&nbsp;</span><span>${e.qty} (Màu: ${e.extendProduct.color})</span>\n                                        </p>\n                                    </td>\n                            </tr> \n                        </tbody>\n                                    `;$("#cartAdd").append(t)},statusCode:{404:function(){alert("Not found!")}}}),$(".popup-detail").fadeOut(0),$(".popup-detail").removeClass("active"),$("body").removeAttr("style"),$(".choose-colorPro ul li").removeClass("active"),$(".number").text(1),$(".minus").attr("style","pointer-events:none;"),$(".minus i").attr("style","background-color:rgb(204, 204, 204)"),$("html, body").animate({scrollTop:0},200),$("#sw_dropdown_135").addClass("open"),$("#dropdown_135").removeClass("hidden"),$("#dropdown_135").attr("style",""),$("#dropdown_135").delay(6e3).fadeOut("slow")}else $(".plChoose-proColor").remove(),$("#orderCheck").append('<span class="plChoose-proColor">*Vui lòng chọn màu sản phẩm</span>')}),$(".plus.orders").on("click",plus),$(".minus.orders").on("click",minus)}if("/cart"==window.location.pathname){function deleteProduct(e){var t=parseInt($(e).attr("data-exProductId")),a=parseInt($(".basket-cart-amount").text()),n=$("#tlocCart").val();const o=(n=JSON.parse("["+n+"]")).find(e=>Math.trunc(e/10)===t),l=n.indexOf(o);o&&(a-=o%10,n.splice(l,1)),$.ajax({type:"POST",url:"/cart/delete",data:{cartAll:n,cartAllAmount:a},dataType:"json",timeout:1e4,success:function(e){localStorage.setItem("local_cartAllAmount",e.cartAllAmount),location.reload()},statusCode:{404:function(){alert("Not deleted!")}}})}function minusChange(e){var t=parseInt($(e).attr("data-exProductId")),a=parseInt($(".basket-cart-amount").text()),n=$("#tlocCart").val();const o=(n=JSON.parse("["+n+"]")).find(e=>Math.trunc(e/10)===t),l=n.indexOf(o);o&&(n[l]=t+String(o%10-1),a-=1),$.ajax({type:"POST",url:"/cart/changeQty",data:{cartAll:n,cartAllAmount:a},dataType:"json",timeout:1e4,success:function(t){localStorage.setItem("local_cartAllAmount",t.cartAllAmount),$("#tlocCart").val(t.cartAll);var a=parseInt($(e).next(".number").text());a<=2?($(e).removeClass(),$(e).children("i").removeClass(),$(e).addClass("minus avoid-clicks"),$(e).children("i").addClass("hideSign"),$(e).next(".number").text(1)):($(e).next(".number").text(a-1),$(e).next().next(".plus").removeClass(),$(e).next().next().addClass("plus allow-clicks"),$(e).next().next().children("i").removeClass(),$(e).next().next().children("i").addClass("showSign")),$(".basket-cart-amount").text(parseInt($(".basket-cart-amount").text())-1),$(".checkout-item-value.total span").text(t.totalMoney.toLocaleString("it-IT"))},statusCode:{404:function(){alert("Not changed!")}}})}function plusChange(e){var t=parseInt($(e).attr("data-exProductId")),a=parseInt($(".basket-cart-amount").text()),n=$("#tlocCart").val();const o=(n=JSON.parse("["+n+"]")).find(e=>Math.trunc(e/10)===t),l=n.indexOf(o);o&&(n[l]=t+String(o%10+1),a+=1),$.ajax({type:"POST",url:"/cart/changeQty",data:{cartAll:n,cartAllAmount:a},dataType:"json",timeout:1e4,success:function(t){localStorage.setItem("local_cartAllAmount",t.cartAllAmount),$("#tlocCart").val(t.cartAll);var a=parseInt($(e).prev(".number").text());a>=order_limit_qty-1?($(e).removeClass(),$(e).children("i").removeClass(),$(e).addClass("plus avoid-clicks"),$(e).children("i").addClass("hideSign"),$(e).prev(".number").text(order_limit_qty)):($(e).prev(".number").text(a+1),$(e).prev().prev(".minus").removeClass(),$(e).prev().prev().addClass("minus allow-clicks"),$(e).prev().prev().children("i").removeClass(),$(e).prev().prev().children("i").addClass("showSign")),$(".basket-cart-amount").text(parseInt($(".basket-cart-amount").text())+1),$(".checkout-item-value.total span").text(t.totalMoney.toLocaleString("it-IT"))},statusCode:{404:function(){alert("Not changed!")}}})}$(document).ready(function(){$(".js-example-basic-single").select2(),$("#elm_name").val(localStorage.getItem("local_elm_name")),$("#elm_phone").val(localStorage.getItem("local_elm_phone")),$("#elm_email").val(localStorage.getItem("local_elm_email")),$("#selCity").select2().on("change",function(){$.ajax({type:"POST",url:"/cart/feeShip",data:{js_nameCity:$("#selCity").val()},dataType:"json",success:function(e){var t="";$.each(e.districtCity,function(e,a){t+=`\n                            <option value="${a.nameDistrict}" data-fee-ship="${a.fee_ship}">${a.nameDistrict}</option>\n                                `}),$("#selDistrict").append(t)},statusCode:{404:function(){alert("Not found!")}}})}),$("#selDistrict").select2().on("change",function(e){var t=$(this).find(":selected").data("fee-ship");$(".fee_ship span").text(t.toLocaleString("it-IT")),$("#ip_fee_ship").val(t.toLocaleString("it-IT"));var a=parseInt($(".checkout-item-value.total").text().replace(/\./g,""));$(".checkout-item-value.total .total_last").text((a+t).toLocaleString("it-IT"))})}),$("#option_cart_group li").one("click",function(e){var t=parseInt($(this).attr("data-exProductId")),a=parseInt($(this).closest("tr").attr("data-exProductId")),n=$("#tlocCart").val();const o=(n=JSON.parse("["+n+"]")).find(e=>Math.trunc(e/10)===a),l=n.indexOf(o);o&&(n[l]=t+String(o%10)),$.ajax({type:"POST",url:"/cart/changeColor",data:{cartAll:n},dataType:"json",timeout:1e4,success:function(e){$("#tlocCart").val(e.cartAll),location.reload()},statusCode:{404:function(){alert("Not changed!")}}})}),$("#elm_name").keyup(function(){localStorage.setItem("local_elm_name",$("#elm_name").val())}),$("#elm_phone").keyup(function(){localStorage.setItem("local_elm_phone",$("#elm_phone").val())}),$("#elm_email").keyup(function(){localStorage.setItem("local_elm_email",$("#elm_email").val())}),$(".tai_cua_hang").click(function(){$("#check_ship").val(0),$("#ip_fee_ship").val(0),$(".fee_ship span").text(0),$("#selCity").prop("required",!1),$("#selDistrict").prop("required",!1),$("#elm_address").prop("required",!1)}),$(".tai_nha").click(function(){$("#check_ship").val(1),$("#selCity").prop("required",!0),$("#selDistrict").prop("required",!0),$("#elm_address").prop("required",!0);var e=$("#selDistrict").select2().find(":selected").data("fee-ship");e&&($("#ip_fee_ship").val(e.toLocaleString("it-IT")),$(".fee_ship span").text(e.toLocaleString("it-IT")))})}let clickSort=0;function fetchData(e,t,a){var n="";$.each(e.products,function(e,t){let a=t.isTraGop,o=t.isHangCongTy,l=t.isSieuGiamGia;n+=`\n                                <div class="product_list_column5" id="container">  \n                                    <div class="grid-list__item ">\n                                                    <div class="grid-list__image"> \n                                                        ${1==o?' <span class="label_cty">Công ty</span> ':""}                                            \n                                                        ${1==a?' <label class="label_installment">Trả góp 0%</label> ':""} \n                                                        ${1==l?'<span class="sticker_mau_4">Siêu giảm giá</span>':""}\n                                                            <a href="/${t.type}/${t.path_url}"\n                                                                title="${t.name}"> \n                                                                <img class="ty-pict cm-image"\n                                                                    alt="${t.name}" \n                                                                    title="${t.name}"\n                                                                    src="/uploads/${t.extend_products[0].path_image}" \n                                                                    width="180" height="180">\n                                                        </a></div>\n                                                    <div class="grid-list__item-name"> \n                                                        <a href="/${t.type}/${t.path_url}"\n                                                        class="product-title">${t.name}</a>\n                                                    </div>\n                                                    <div class="grid-list__price"> <span class="cm-reload-3576 price-update"\n                                                            id="price_update_3576"> <input type="hidden"\n                                                                name="appearance[show_price_values]" value="1"> <input type="hidden"\n                                                                name="appearance[show_price]" value="1"> <span class="price"\n                                                                id="line_discounted_price_3576">\n                                                                <span id="sec_discounted_price_3576" class="price-num" id="price-num">${parseInt(t.price).toLocaleString("it-IT")}</span><span class="price-num"><sup style="font-size:smaller">₫</sup>\n                                                                    </span>\n                                                                </span>\n                                                        </span> <span class="cm-reload-3576" id="old_price_update_3576">\n                                                        </span> \n                                                    </div>                                            \n                                    </div>\n                                </div>\n                                `}),n+=` ${e.number_left>0?`<p class="clearfix" id="p_xoa"></p><a class="more_load_page ld-ext-right" id="load_more" onclick="this.classList.toggle('running')">\n                                                            Xem thêm ${e.number_left+" "+a.toLowerCase()}<div class="ld ld-ring ld-spin"></div></a>`:""}`,t?$("#danhmuc").html(n):$("#danhmuc").append(n)}$("#sw_elm_sort_fields").click(e=>{clickSort%2==0&&$("html,body").animate({scrollTop:$(".manunew").offset().top-5},"slow"),clickSort++}),$(".cancel-order__cancel-button").on("click",function(){$(".cancel-order-popup").attr("style","")}),$(".close-cancel-popup").on("click",function(){$(".cancel-order-popup").attr("style","display:none")}),$(".confirm-cancel-popup").on("click",function(){$.ajax({type:"POST",url:"/cart/cancelOrders",data:{order_successId:$("#order_successId").val()},dataType:"json",timeout:1e4,success:function(e){if(e.checkSuccess){$(".cancel-order-popup").attr("style","display:none"),$(".success-popup").attr("style",""),$(".success-popup div").append('<p class="conut-success"> Tự động đóng trong <b>5</b> giây </p>');var t=5,a=setInterval(function(){t--,$(".conut-success b").text(t),1==t&&(clearInterval(a),window.location.replace("/"))},1e3)}else $(".success-popup div h1").text("Hủy đơn hàng thất bại"),$(".success-popup div .popup-detail").text("Đơn hàng của bạn có thể đã được nhân viên xác nhận. Vui lòng liên hệ tổng đài!"),$(".cancel-order-popup").attr("style","display:none"),$(".success-popup").attr("style","")},statusCode:{404:function(){alert("Not changed!")}}})}),$(".success-cencell-popup").on("click",function(){window.location.replace("/")});